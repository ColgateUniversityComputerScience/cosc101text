
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>12. Dictionaries &#8212; Solving Problems with Python (version 07.2015)</title>
    <link rel="stylesheet" href="_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="13. Tuples" href="tuples.html" />
    <link rel="prev" title="11. Lists" href="lists.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="tuples.html" title="13. Tuples"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="lists.html" title="11. Lists"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Solving Problems with Python (version 07.2015)</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">12. Dictionaries</a><ul>
<li><a class="reference internal" href="#dictionary-as-a-set-of-counters">12.1. Dictionary as a set of counters</a></li>
<li><a class="reference internal" href="#looping-and-dictionaries">12.2. Looping and dictionaries</a></li>
<li><a class="reference internal" href="#reverse-lookup">12.3. Reverse lookup</a></li>
<li><a class="reference internal" href="#dictionaries-and-lists">12.4. Dictionaries and lists</a></li>
<li><a class="reference internal" href="#memos">12.5. Memos</a></li>
<li><a class="reference internal" href="#debugging">12.6. Debugging</a></li>
<li><a class="reference internal" href="#glossary">12.7. Glossary</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="lists.html"
                        title="previous chapter">11. Lists</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="tuples.html"
                        title="next chapter">13. Tuples</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/dictionaries.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="dictionaries">
<h1>12. Dictionaries<a class="headerlink" href="#dictionaries" title="Permalink to this headline">¶</a></h1>
<p>A <strong>dictionary</strong> is like a list, but more general. In a list, the
indices have to be integers; in a dictionary they can be (almost) any
type.</p>
<p>You can think of a dictionary as a mapping between a set of indices
(which are called <strong>keys</strong>) and a set of values. Each key maps to a
value. The association of a key and a value is called a <strong>key-value
pair</strong> or sometimes an <strong>item</strong>. Because of the way that dictionaries
work, they're also called associative arrays.</p>
<p>As an example, we’ll build a dictionary that maps from English to
Spanish words, so the keys and the values are all strings.</p>
<p>The function <code class="docutils literal notranslate"><span class="pre">dict</span></code> creates a new dictionary with no items. Because
<code class="docutils literal notranslate"><span class="pre">dict</span></code> is the name of a built-in function, you should avoid using it
as a variable name.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">eng2sp</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">eng2sp</span>
<span class="go">{}</span>
</pre></div>
</div>
<p>The squiggly-brackets, <code class="docutils literal notranslate"><span class="pre">{}</span></code>, represent an empty dictionary. To add
items to the dictionary, you can use square brackets:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">eng2sp</span><span class="p">[</span><span class="s1">&#39;one&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;uno&#39;</span>
</pre></div>
</div>
<p>This line creates an item that maps from the key <code class="docutils literal notranslate"><span class="pre">'one'</span></code> to the value
<code class="docutils literal notranslate"><span class="pre">'uno'</span></code>. If we print the dictionary again, we see a key-value pair
with a colon between the key and value:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">eng2sp</span>
<span class="go">{&#39;one&#39;: &#39;uno&#39;}</span>
</pre></div>
</div>
<p>This output format is also an input format. For example, you can create
a new dictionary with three items:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">eng2sp</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;one&#39;</span><span class="p">:</span> <span class="s1">&#39;uno&#39;</span><span class="p">,</span> <span class="s1">&#39;two&#39;</span><span class="p">:</span> <span class="s1">&#39;dos&#39;</span><span class="p">,</span> <span class="s1">&#39;three&#39;</span><span class="p">:</span> <span class="s1">&#39;tres&#39;</span><span class="p">}</span>
</pre></div>
</div>
<p>But if you print <code class="docutils literal notranslate"><span class="pre">eng2sp</span></code>, you might be surprised:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">eng2sp</span>
<span class="go">{&#39;one&#39;: &#39;uno&#39;, &#39;three&#39;: &#39;tres&#39;, &#39;two&#39;: &#39;dos&#39;}</span>
</pre></div>
</div>
<p>The order of the key-value pairs is not the same. In fact, if you type
the same example on your computer, you might get a different result. In
general, the order of items in a dictionary is unpredictable.</p>
<p>But that’s not a problem because the elements of a dictionary are never
indexed with integer indices. Instead, you use the keys to look up the
corresponding values:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">eng2sp</span><span class="p">[</span><span class="s1">&#39;two&#39;</span><span class="p">]</span>
<span class="go">&#39;dos&#39;</span>
</pre></div>
</div>
<p>The key <code class="docutils literal notranslate"><span class="pre">'two'</span></code> always maps to the value <code class="docutils literal notranslate"><span class="pre">'dos'</span></code> so the order of the
items doesn’t matter.</p>
<p>If the key isn’t in the dictionary, you get an exception:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">eng2sp</span><span class="p">[</span><span class="s1">&#39;four&#39;</span><span class="p">]</span>
<span class="go">KeyError: &#39;four&#39;</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">len</span></code> function works on dictionaries; it returns the number of
key-value pairs:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">eng2sp</span><span class="p">)</span>
<span class="go">3</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">in</span></code> operator works on dictionaries; it tells you whether
something appears as a <em>key</em> in the dictionary (appearing as a value is
not good enough).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="s1">&#39;one&#39;</span> <span class="ow">in</span> <span class="n">eng2sp</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="s1">&#39;uno&#39;</span> <span class="ow">in</span> <span class="n">eng2sp</span>
<span class="go">False</span>
</pre></div>
</div>
<p>To see whether something appears as a value in a dictionary, you can use
the method <code class="docutils literal notranslate"><span class="pre">values</span></code>, which returns the values as a list, and then use
the <code class="docutils literal notranslate"><span class="pre">in</span></code> operator:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">vals</span> <span class="o">=</span> <span class="n">eng2sp</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="s1">&#39;uno&#39;</span> <span class="ow">in</span> <span class="n">vals</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">in</span></code> operator uses different algorithms for lists and
dictionaries. For lists, it uses a search algorithm, as in the <code class="docutils literal notranslate"><span class="pre">find</span></code>
function we wrote earlier. As the list gets longer, the search time gets
longer in direct proportion. For dictionaries, Python uses an algorithm
called a <strong>hashtable</strong> that has a remarkable property: the <code class="docutils literal notranslate"><span class="pre">in</span></code>
operator takes about the same amount of time no matter how many items
there are in a dictionary. I won’t explain how that’s possible, but you
can read more about it at <a class="reference external" href="http://wikipedia.org/wiki/Hash_table">http://wikipedia.org/wiki/Hash_table</a>.</p>
<blockquote>
<div><p><strong>Example</strong>:</p>
<ol class="arabic simple">
<li>Write a function that reads the words in <code class="docutils literal notranslate"><span class="pre">words.txt</span></code> and stores
them as keys in a dictionary. It doesn’t matter what the values
are. Then you can use the <code class="docutils literal notranslate"><span class="pre">in</span></code> operator as a fast way to check
whether a string is in the dictionary.</li>
</ol>
</div></blockquote>
<div class="section" id="dictionary-as-a-set-of-counters">
<h2>12.1. Dictionary as a set of counters<a class="headerlink" href="#dictionary-as-a-set-of-counters" title="Permalink to this headline">¶</a></h2>
<p>Suppose you are given a string and you want to count how many times each
letter appears. There are several ways you could do it:</p>
<ol class="arabic simple">
<li>You could create 26 variables, one for each letter of the alphabet.
Then you could traverse the string and, for each character, increment
the corresponding counter, probably using a chained conditional.</li>
<li>You could create a list with 26 elements. Then you could convert each
character to a number (using the built-in function <code class="docutils literal notranslate"><span class="pre">ord</span></code>), use the
number as an index into the list, and increment the appropriate
counter.</li>
<li>You could create a dictionary with characters as keys and counters as
the corresponding values. The first time you see a character, you
would add an item to the dictionary. After that you would increment
the value of an existing item.</li>
</ol>
<p>Each of these options performs the same computation, but each of them
implements that computation in a different way.</p>
<p>An <strong>implementation</strong> is a way of performing a computation; some
implementations are better than others. For example, an advantage of the
dictionary implementation is that we don’t have to know ahead of time
which letters appear in the string and we only have to make room for the
letters that do appear.</p>
<p>Here is what the code might look like:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">histogram</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="n">d</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">s</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">c</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">d</span><span class="p">:</span>
            <span class="n">d</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">d</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">d</span>
</pre></div>
</div>
<p>The name of the function is <strong>histogram</strong>, which is a statistical term
for a set of counters (or frequencies).</p>
<p>The first line of the function creates an empty dictionary. The <code class="docutils literal notranslate"><span class="pre">for</span></code>
loop traverses the string. Each time through the loop, if the character
<code class="docutils literal notranslate"><span class="pre">c</span></code> is not in the dictionary, we create a new item with key <code class="docutils literal notranslate"><span class="pre">c</span></code> and
the initial value 1 (since we have seen this letter once). If <code class="docutils literal notranslate"><span class="pre">c</span></code> is
already in the dictionary we increment <code class="docutils literal notranslate"><span class="pre">d[c]</span></code>.</p>
<p>Here’s how it works:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">h</span> <span class="o">=</span> <span class="n">histogram</span><span class="p">(</span><span class="s1">&#39;brontosaurus&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">h</span>
<span class="go">{&#39;a&#39;: 1, &#39;b&#39;: 1, &#39;o&#39;: 2, &#39;n&#39;: 1, &#39;s&#39;: 2, &#39;r&#39;: 2, &#39;u&#39;: 2, &#39;t&#39;: 1}</span>
</pre></div>
</div>
<p>The histogram indicates that the letters <code class="docutils literal notranslate"><span class="pre">'a'</span></code> and <code class="docutils literal notranslate"><span class="pre">'b'</span></code> appear
once; <code class="docutils literal notranslate"><span class="pre">'o'</span></code> appears twice, and so on.</p>
<p><strong>Example</strong>:</p>
<blockquote>
<div><ol class="arabic simple">
<li>Dictionaries have a method called <code class="docutils literal notranslate"><span class="pre">get</span></code> that takes a key and a
default value. If the key appears in the dictionary, <code class="docutils literal notranslate"><span class="pre">get</span></code>
returns the corresponding value; otherwise it returns the default
value. For example:</li>
</ol>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">h</span> <span class="o">=</span> <span class="n">histogram</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">h</span>
<span class="go">{&#39;a&#39;: 1}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
<blockquote>
<div>Use <code class="docutils literal notranslate"><span class="pre">get</span></code> to write <code class="docutils literal notranslate"><span class="pre">histogram</span></code> more concisely. You should be
able to eliminate the <code class="docutils literal notranslate"><span class="pre">if</span></code> statement.</div></blockquote>
</div>
<div class="section" id="looping-and-dictionaries">
<h2>12.2. Looping and dictionaries<a class="headerlink" href="#looping-and-dictionaries" title="Permalink to this headline">¶</a></h2>
<p>If you use a dictionary in a <code class="docutils literal notranslate"><span class="pre">for</span></code> statement, it traverses the keys of
the dictionary. For example, <code class="docutils literal notranslate"><span class="pre">print_hist</span></code> prints each key and the
corresponding value:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">print_hist</span><span class="p">(</span><span class="n">h</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">h</span><span class="p">:</span>
        <span class="k">print</span> <span class="n">c</span><span class="p">,</span> <span class="n">h</span><span class="p">[</span><span class="n">c</span><span class="p">]</span>
</pre></div>
</div>
<p>Here’s what the output looks like:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">h</span> <span class="o">=</span> <span class="n">histogram</span><span class="p">(</span><span class="s1">&#39;parrot&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">print_hist</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
<span class="go">a 1</span>
<span class="go">p 1</span>
<span class="go">r 2</span>
<span class="go">t 1</span>
<span class="go">o 1</span>
</pre></div>
</div>
<p>Again, the keys are in no particular order.</p>
<blockquote>
<div><p><strong>Example</strong>:</p>
<ol class="arabic">
<li><p class="first">Dictionaries have a method called <code class="docutils literal notranslate"><span class="pre">keys</span></code> that returns the keys
of the dictionary, in no particular order, as a list.</p>
<p>Modify <code class="docutils literal notranslate"><span class="pre">print_hist</span></code> to print the keys and their values in
alphabetical order.</p>
</li>
</ol>
</div></blockquote>
</div>
<div class="section" id="reverse-lookup">
<h2>12.3. Reverse lookup<a class="headerlink" href="#reverse-lookup" title="Permalink to this headline">¶</a></h2>
<p>Given a dictionary <code class="docutils literal notranslate"><span class="pre">d</span></code> and a key <code class="docutils literal notranslate"><span class="pre">k</span></code>, it is easy to find the
corresponding value <code class="docutils literal notranslate"><span class="pre">v</span> <span class="pre">=</span> <span class="pre">d[k]</span></code>. This operation is called a <strong>lookup</strong>.</p>
<p>But what if you have <code class="docutils literal notranslate"><span class="pre">v</span></code> and you want to find <code class="docutils literal notranslate"><span class="pre">k</span></code>? You have two
problems: first, there might be more than one key that maps to the value
<code class="docutils literal notranslate"><span class="pre">v</span></code>. Depending on the application, you might be able to pick one, or
you might have to make a list that contains all of them. Second, there
is no simple syntax to do a <strong>reverse lookup</strong>; you have to search.</p>
<p>Here is a function that takes a value and returns the first key that
maps to that value:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">reverse_lookup</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">d</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">d</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">==</span> <span class="n">v</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">k</span>
    <span class="k">raise</span> <span class="ne">ValueError</span>
</pre></div>
</div>
<p>This function is yet another example of the search pattern, but it uses
a feature we haven’t seen before, <code class="docutils literal notranslate"><span class="pre">raise</span></code>. The <code class="docutils literal notranslate"><span class="pre">raise</span></code> statement
causes an exception; in this case it causes a <code class="docutils literal notranslate"><span class="pre">ValueError</span></code>, which
generally indicates that there is something wrong with the value of a
parameter.</p>
<p>If we get to the end of the loop, that means <code class="docutils literal notranslate"><span class="pre">v</span></code> doesn’t appear in the
dictionary as a value, so we raise an exception.</p>
<p>Here is an example of a successful reverse lookup:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">h</span> <span class="o">=</span> <span class="n">histogram</span><span class="p">(</span><span class="s1">&#39;parrot&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">k</span> <span class="o">=</span> <span class="n">reverse_lookup</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">k</span>
<span class="go">r</span>
</pre></div>
</div>
<p>And an unsuccessful one:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">k</span> <span class="o">=</span> <span class="n">reverse_lookup</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
  File <span class="nb">&quot;&lt;stdin&gt;&quot;</span>, line <span class="m">1</span>, in <span class="n">?</span>
  File <span class="nb">&quot;&lt;stdin&gt;&quot;</span>, line <span class="m">5</span>, in <span class="n">reverse_lookup</span>
<span class="gr">ValueError</span>
</pre></div>
</div>
<p>The result when you raise an exception is the same as when Python raises
one: it prints a traceback and an error message.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">raise</span></code> statement takes a detailed error message as an optional
argument. For example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">raise</span> <span class="ne">ValueError</span><span class="p">,</span> <span class="s1">&#39;value does not appear in the dictionary&#39;</span>
<span class="gt">Traceback (most recent call last):</span>
  File <span class="nb">&quot;&lt;stdin&gt;&quot;</span>, line <span class="m">1</span>, in <span class="n">?</span>
<span class="gr">ValueError</span>: <span class="n">value does not appear in the dictionary</span>
</pre></div>
</div>
<p>A reverse lookup is much slower than a forward lookup; if you have to do
it often, or if the dictionary gets big, the performance of your program
will suffer.</p>
<blockquote>
<div><p><strong>Example</strong>:</p>
<ol class="arabic simple">
<li>Modify <code class="docutils literal notranslate"><span class="pre">reverse_lookup</span></code> so that it builds and returns a list of
<em>all</em> keys that map to <code class="docutils literal notranslate"><span class="pre">v</span></code>, or an empty list if there are none.</li>
</ol>
</div></blockquote>
</div>
<div class="section" id="dictionaries-and-lists">
<h2>12.4. Dictionaries and lists<a class="headerlink" href="#dictionaries-and-lists" title="Permalink to this headline">¶</a></h2>
<p>Lists can appear as values in a dictionary. For example, if you were
given a dictionary that maps from letters to frequencies, you might want
to invert it; that is, create a dictionary that maps from frequencies to
letters. Since there might be several letters with the same frequency,
each value in the inverted dictionary should be a list of letters.</p>
<p>Here is a function that inverts a dictionary:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">invert_dict</span><span class="p">(</span><span class="n">d</span><span class="p">):</span>
    <span class="n">inv</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">d</span><span class="p">:</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">val</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">inv</span><span class="p">:</span>
            <span class="n">inv</span><span class="p">[</span><span class="n">val</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">key</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">inv</span><span class="p">[</span><span class="n">val</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">inv</span>
</pre></div>
</div>
<p>Each time through the loop, <code class="docutils literal notranslate"><span class="pre">key</span></code> gets a key from <code class="docutils literal notranslate"><span class="pre">d</span></code> and <code class="docutils literal notranslate"><span class="pre">val</span></code>
gets the corresponding value. If <code class="docutils literal notranslate"><span class="pre">val</span></code> is not in <code class="docutils literal notranslate"><span class="pre">inv</span></code>, that means
we haven’t seen it before, so we create a new item and initialize it
with a <strong>singleton</strong> (a list that contains a single element). Otherwise
we have seen this value before, so we append the corresponding key to
the list.</p>
<p>Here is an example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hist</span> <span class="o">=</span> <span class="n">histogram</span><span class="p">(</span><span class="s1">&#39;parrot&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">hist</span>
<span class="go">{&#39;a&#39;: 1, &#39;p&#39;: 1, &#39;r&#39;: 2, &#39;t&#39;: 1, &#39;o&#39;: 1}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inv</span> <span class="o">=</span> <span class="n">invert_dict</span><span class="p">(</span><span class="n">hist</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">inv</span>
<span class="go">{1: [&#39;a&#39;, &#39;p&#39;, &#39;t&#39;, &#39;o&#39;], 2: [&#39;r&#39;]}</span>
</pre></div>
</div>
<p>And here is a diagram showing <code class="docutils literal notranslate"><span class="pre">hist</span></code> and <code class="docutils literal notranslate"><span class="pre">inv</span></code>:</p>
<div class="figure align-center" id="id5">
<img alt="The dictionary ``hist`` and its &quot;inverted&quot; equivalent ``inv``." src="_images/dict1.png" />
<p class="caption"><span class="caption-text">The dictionary <code class="docutils literal notranslate"><span class="pre">hist</span></code> and its &quot;inverted&quot; equivalent <code class="docutils literal notranslate"><span class="pre">inv</span></code>.</span></p>
</div>
<p>A dictionary is represented as a box with the type <code class="docutils literal notranslate"><span class="pre">dict</span></code> above it and
the key-value pairs inside. If the values are integers, floats or
strings, I usually draw them inside the box, but I usually draw lists
outside the box, just to keep the diagram simple.</p>
<p>Lists can be values in a dictionary, as this example shows, but they
cannot be keys. Here’s what happens if you try:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;oops&#39;</span>
<span class="gt">Traceback (most recent call last):</span>
  File <span class="nb">&quot;&lt;stdin&gt;&quot;</span>, line <span class="m">1</span>, in <span class="n">?</span>
<span class="gr">TypeError</span>: <span class="n">list objects are unhashable</span>
</pre></div>
</div>
<p>I mentioned earlier that a dictionary is implemented using a hashtable
and that means that the keys have to be <strong>hashable</strong>.</p>
<p>A <strong>hash</strong> is a function that takes a value (of any kind) and returns an
integer. Dictionaries use these integers, called hash values, to store
and look up key-value pairs.</p>
<p>This system works fine if the keys are immutable. But if the keys are
mutable, like lists, bad things happen. For example, when you create a
key-value pair, Python hashes the key and stores it in the corresponding
location. If you modify the key and then hash it again, it would go to a
different location. In that case you might have two entries for the same
key, or you might not be able to find a key. Either way, the dictionary
wouldn’t work correctly.</p>
<p>That’s why the keys have to be hashable, and why mutable types like
lists aren’t. The simplest way to get around this limitation is to use
tuples, which we will see in the next chapter.</p>
<p>Since dictionaries are mutable, they can’t be used as keys, but they
<em>can</em> be used as values.</p>
</div>
<div class="section" id="memos">
<h2>12.5. Memos<a class="headerlink" href="#memos" title="Permalink to this headline">¶</a></h2>
<p>If you played with the <code class="docutils literal notranslate"><span class="pre">`fibonacci</span></code> function &lt;#sec:fibonacci&gt;`_, you
might have noticed that the bigger the argument you provide, the longer
the function takes to run. Furthermore, the run time increases very
quickly.</p>
<p>To understand why, consider this <strong>call graph</strong> for <code class="docutils literal notranslate"><span class="pre">fibonacci</span></code> with
<code class="docutils literal notranslate"><span class="pre">n=4</span></code>:</p>
<div class="figure align-center" id="id6">
<img alt="Fibonacci function call graph." src="_images/fibonacci.png" />
<p class="caption"><span class="caption-text">Fibonacci function call graph.</span></p>
</div>
<p>A call graph shows a set of function frames, with lines connecting each
frame to the frames of the functions it calls. At the top of the graph,
<code class="docutils literal notranslate"><span class="pre">fibonacci</span></code> with <code class="docutils literal notranslate"><span class="pre">n=4</span></code> calls <code class="docutils literal notranslate"><span class="pre">fibonacci</span></code> with <code class="docutils literal notranslate"><span class="pre">n=3</span></code> and <code class="docutils literal notranslate"><span class="pre">n=2</span></code>.
In turn, <code class="docutils literal notranslate"><span class="pre">fibonacci</span></code> with <code class="docutils literal notranslate"><span class="pre">n=3</span></code> calls <code class="docutils literal notranslate"><span class="pre">fibonacci</span></code> with <code class="docutils literal notranslate"><span class="pre">n=2</span></code> and
<code class="docutils literal notranslate"><span class="pre">n=1</span></code>. And so on.</p>
<p>Count how many times <code class="docutils literal notranslate"><span class="pre">fibonacci(0)</span></code> and <code class="docutils literal notranslate"><span class="pre">fibonacci(1)</span></code> are called.
This is an inefficient solution to the problem, and it gets worse as the
argument gets bigger.</p>
<p>One solution is to keep track of values that have already been computed
by storing them in a dictionary. A previously computed value that is
stored for later use is called a <strong>memo</strong> <a class="footnote-reference" href="#id3" id="id1">[1]</a>. Here is an
implementation of <code class="docutils literal notranslate"><span class="pre">fibonacci</span></code> using memos:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">known</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">}</span>

<span class="k">def</span> <span class="nf">fibonacci</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">known</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">known</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>

    <span class="n">res</span> <span class="o">=</span> <span class="n">fibonacci</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">fibonacci</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">known</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">res</span>
    <span class="k">return</span> <span class="n">res</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">known</span></code> is a dictionary that keeps track of the Fibonacci numbers we
already know. It starts with two items: 0 maps to 0 and 1 maps to 1.</p>
<p>Whenever <code class="docutils literal notranslate"><span class="pre">fibonacci</span></code> is called, it checks <code class="docutils literal notranslate"><span class="pre">known</span></code>. If the result is
already there, it can return immediately. Otherwise it has to compute
the new value, add it to the dictionary, and return it.</p>
<blockquote>
<div><p><strong>Example</strong>:</p>
<ol class="arabic simple">
<li>Run this version of <code class="docutils literal notranslate"><span class="pre">fibonacci</span></code> and the original with a range
of parameters and compare their run times.</li>
</ol>
</div></blockquote>
</div>
<div class="section" id="debugging">
<h2>12.6. Debugging<a class="headerlink" href="#debugging" title="Permalink to this headline">¶</a></h2>
<p>As you work with bigger datasets it can become unwieldy to debug by
printing and checking data by hand. Here are some suggestions for
debugging large datasets:</p>
<ul class="simple">
<li>Scale down the input:<ul>
<li>If possible, reduce the size of the dataset. For example if the
program reads a text file, start with just the first 10 lines, or
with the smallest example you can find. You can either edit the
files themselves, or (better) modify the program so it reads only
the first <code class="docutils literal notranslate"><span class="pre">n</span></code> lines.</li>
<li>If there is an error, you can reduce <code class="docutils literal notranslate"><span class="pre">n</span></code> to the smallest value
that manifests the error, and then increase it gradually as you
find and correct errors.</li>
</ul>
</li>
<li>Check summaries and types:<ul>
<li>Instead of printing and checking the entire dataset, consider
printing summaries of the data: for example, the number of items
in a dictionary or the total of a list of numbers.</li>
<li>A common cause of runtime errors is a value that is not the right
type. For debugging this kind of error, it is often enough to
print the type of a value.</li>
</ul>
</li>
<li>Write self-checks:<ul>
<li>Sometimes you can write code to check for errors automatically.
For example, if you are computing the average of a list of
numbers, you could check that the result is not greater than the
largest element in the list or less than the smallest. This is
called a “sanity check” because it detects results that are
“insane.”</li>
<li>Another kind of check compares the results of two different
computations to see if they are consistent. This is called a
“consistency check.”</li>
</ul>
</li>
</ul>
<p>Again, time you spend building scaffolding can reduce the time you spend
debugging.</p>
</div>
<div class="section" id="glossary">
<h2>12.7. Glossary<a class="headerlink" href="#glossary" title="Permalink to this headline">¶</a></h2>
<dl class="docutils">
<dt>dictionary:</dt>
<dd>A mapping from a set of keys to their corresponding values.</dd>
<dt>key-value pair:</dt>
<dd>The representation of the mapping from a key to a value.</dd>
<dt>item:</dt>
<dd>Another name for a key-value pair.</dd>
<dt>key:</dt>
<dd>An object that appears in a dictionary as the first part of a
key-value pair.</dd>
<dt>value:</dt>
<dd>An object that appears in a dictionary as the second part of a
key-value pair. This is more specific than our previous use of the
word “value.”</dd>
<dt>implementation:</dt>
<dd>A way of performing a computation.</dd>
<dt>hashtable:</dt>
<dd>The algorithm used to implement Python dictionaries.</dd>
<dt>hash function:</dt>
<dd>A function used by a hashtable to compute the location for a key.</dd>
<dt>hashable:</dt>
<dd>A type that has a hash function. Immutable types like integers,
floats and strings are hashable; mutable types like lists and
dictionaries are not.</dd>
<dt>lookup:</dt>
<dd>A dictionary operation that takes a key and finds the corresponding
value.</dd>
<dt>reverse lookup:</dt>
<dd>A dictionary operation that takes a value and finds one or more keys
that map to it.</dd>
<dt>singleton:</dt>
<dd>A list (or other sequence) with a single element.</dd>
<dt>call graph:</dt>
<dd>A diagram that shows every frame created during the execution of a
program, with an arrow from each caller to each callee.</dd>
<dt>histogram:</dt>
<dd>A set of counters.</dd>
<dt>memo:</dt>
<dd>A computed value stored to avoid unnecessary future computation.</dd>
</dl>
<p class="rubric">Exercises</p>
<ol class="arabic">
<li><p class="first">Use a dictionary to write a faster, simpler version of
<code class="docutils literal notranslate"><span class="pre">has_duplicates</span></code>. This function should take a list as a
parameter and return <code class="docutils literal notranslate"><span class="pre">True</span></code> if there is any object that appears
more than once in the list.</p>
</li>
<li><p class="first">Two words are &quot;rotate pairs&quot; if you can rotate one of them and
get the other.</p>
<p>Write a program that reads a wordlist and finds all the rotate
pairs.</p>
</li>
<li><p class="first">Here’s another Puzzler from <em>Car Talk</em> <a class="footnote-reference" href="#id4" id="id2">[2]</a>:</p>
<p>&quot;This was sent in by a fellow named Dan O’Leary. He came upon a
common one-syllable, five-letter word recently that has the
following unique property. When you remove the first letter, the
remaining letters form a homophone of the original word, that is
a word that sounds exactly the same. Replace the first letter,
that is, put it back and remove the second letter and the result
is yet another homophone of the original word. And the question
is, what’s the word?</p>
<p>&quot;Now I’m going to give you an example that doesn’t work. Let’s
look at the five-letter word, ‘wrack.’ W-R-A-C-K, you know like
to ‘wrack with pain.’ If I remove the first letter, I am left
with a four-letter word, ’R-A-C-K.’ As in, ‘Holy cow, did you see
the rack on that buck! It must have been a nine-pointer!’ It’s a
perfect homophone. If you put the ‘w’ back, and remove the ‘r,’
instead, you’re left with the word, ‘wack,’ which is a real word,
it’s just not a homophone of the other two words.</p>
<p>&quot;But there is, however, at least one word that Dan and we know
of, which will yield two homophones if you remove either of the
first two letters to make two, new four-letter words. The
question is, what’s the word?&quot;</p>
<p>To check whether two words are homophones, you can use the CMU
Pronouncing Dictionary. You can download it from
<a class="reference external" href="http://www.speech.cs.cmu.edu/cgi-bin/cmudict">http://www.speech.cs.cmu.edu/cgi-bin/cmudict</a>. (The file you're
looking for is a text file named <code class="docutils literal notranslate"><span class="pre">cmudict.0.7a</span></code>.)</p>
<p>Write a program that lists all the words that solve the Puzzler.</p>
</li>
</ol>
<p class="rubric">Footnotes</p>
<table class="docutils footnote" frame="void" id="id3" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[1]</a></td><td>See <a class="reference external" href="http://wikipedia.org/wiki/Memoization">http://wikipedia.org/wiki/Memoization</a>.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id4" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[2]</a></td><td><a class="reference external" href="http://www.cartalk.com/content/puzzler/transcripts/200717">http://www.cartalk.com/content/puzzler/transcripts/200717</a>.</td></tr>
</tbody>
</table>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="tuples.html" title="13. Tuples"
             >next</a> |</li>
        <li class="right" >
          <a href="lists.html" title="11. Lists"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Solving Problems with Python (version 07.2015)</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2012-2015, Joel Sommers, Ed..
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.8.
    </div>
  </body>
</html>